if (self.CavalryLogger) { CavalryLogger.start_js(["hqDss"]); }

__d("XSearchBootstrapEntityModuleLoggingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/search\/async\/bootstrap_entity_module_logging\/",{session_id:{type:"String",required:true},logging_unit_id:{type:"String",required:true},query:{type:"String",required:true},query_function:{type:"String",required:true},results_module_role:{type:"String",required:true},tapped_results_entity_id:{type:"String"},log_module_impression:{type:"Bool",defaultValue:false}});}),null);
__d("XSearchBrowseActionsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/search\/async\/browse_actions\/",{id:{type:"String",required:true},result_type:{type:"String",required:true},viewer_id:{type:"FBID",required:true}});}),null);
__d('SearchEntityModuleResult.react',['cx','fbt','AsyncRequest','Badge.react','BrowseClientEventLogger','CurrentUser','DOM','DOMContainer.react','HovercardLink','Image.react','Link.react','React','SearchEntityModuleServerConstants','URI','WebPixelRatio','XSearchBootstrapEntityModuleLoggingController','XSearchBrowseActionsController','XUIButton.react','XUISpinner.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l,m=c('SearchEntityModuleServerConstants').MODULE_STYLE,n=(l={},l[m.SMALL]=48,l[m.MEDIUM]=64,l[m.LARGE]=72,l[m.XLARGE]=100,l);j=babelHelpers.inherits(o,c('React').Component);k=j&&j.prototype;function o(p){k.constructor.call(this,p);this.actionsWrapper=c('DOM').create('div');this.crActionsWrapper=c('DOM').create('div');this.state={actionsLoaded:false,showCrActions:false};}o.prototype.componentDidMount=function(){this.renderActions();this.logImpression();if(this.props.result.logging_unit_id!=null&&this.props.result.is_bootstrap)this.logUnitData();};o.prototype.render=function(){var p,q=this.props.result.uri,r=c('HovercardLink').constructEndpoint({id:this.props.result.tuid}),s=void 0;if(this.props.result.badge_type){s=c('React').createElement(c('Badge.react'),{type:this.props.result.badge_type,size:'small'});}else if(this.props.result.is_verified===true)s=c('React').createElement(c('Badge.react'),{type:'verified',size:'small'});var t=this.props.result.snippets.map(function(da,ea){return c('React').createElement(c('DOMContainer.react'),{key:'snippet_'+ea,className:(ea===0?"_2yep":'')+(ea!==0?' '+"_2yeq":'')},da);}),u=this.props.result.photos,v=void 0,w=n[this.props.module_style],x=void 0;if(!c('CurrentUser').isWorkUser()&&this.props.result.type==='user'){x=new (c('URI'))('https://graph.facebook.com/'+this.props.result.tuid+'/picture').setQueryData({width:w*c('WebPixelRatio').getOriginalValue(),height:w*c('WebPixelRatio').getOriginalValue()}).toString();}else x=this.props.result.photo;if(u!=null&&!this.props.has_module_guidelines){(function(){var da=u.length,ea=u.map(function(fa,ga){var ha=w/2-ga%2,ia=w/2-Math.round(ga/da);return c('React').createElement(c('Image.react'),{key:ga,className:"_4wq6",src:fa,style:{width:ha+'px',height:ia+'px'}});});v=c('React').createElement('div',{className:"_4wq7",style:{width:w+'px',height:w+'px'}},ea);})();}else{var y=false;if(this.props.result.type==='group')y=this.props.has_module_guidelines;v=c('React').createElement(c('Image.react'),{className:"_2yeu"+(y?' '+"_4lxz":''),src:x,width:w,height:w});}var z=c('React').createElement('div',{className:"_2ye_"},c('React').createElement(c('DOMContainer.react'),null,this.actionsWrapper),c('React').createElement(c('XUIButton.react'),{className:"_4cei"+(this.state.actionsLoaded?' '+"hidden_elem":''),image:c('React').createElement(c('XUISpinner.react'),{size:'small',background:'dark'}),label:i._("Loading...")})),aa=null;if(this.state.showCrActions&&this.crActionsWrapper)aa=c('React').createElement('div',{className:"_5-zc"},c('React').createElement(c('DOMContainer.react'),null,this.crActionsWrapper),c('React').createElement(c('XUIButton.react'),{className:"_4cei"+(this.state.actionsLoaded?' '+"hidden_elem":''),image:c('React').createElement(c('XUISpinner.react'),{size:'small',background:'dark'}),label:i._("Loading...")}));var ba=this.props.module_style===m.XLARGE||this.props.module_style===m.LARGE,ca=null;if(this.props.has_module_guidelines){ca=c('React').createElement('div',{style:{WebkitLineClamp:2},className:"_52eh _5bcu"},this.props.result.text,s);}else ca=c('React').createElement('div',null,this.props.result.text,s);return c('React').createElement('div',babelHelpers['extends']({className:"_2yer"+(' '+"_401d")+(ba?' '+"_2xje":'')+(' '+"_2nuh")},this.getLoggingData()),c('React').createElement(c('Link.react'),{className:"_2yet",href:q,'data-hovercard':r},v),c('React').createElement('div',{className:"_2yev"},c('React').createElement('div',{className:"_2xjf"},c('React').createElement(c('Link.react'),{href:q,className:(this.props.has_module_guidelines?"_1ii5":'')+(' '+"_2yez"),'data-hovercard':r},ca),ba?z:null),c('React').createElement('div',{className:"_2ye-"},t.shift(),c('React').createElement('div',{className:"_2xjg"},t)),aa),ba?null:z);};o.prototype.renderActions=function(){var p=c('SearchEntityModuleServerConstants').TYPE_TO_BROWSE_TYPE[this.props.result.type],q=c('XSearchBrowseActionsController').getURIBuilder().setString('id',this.props.result.tuid).setString('result_type',p).setFBID('viewer_id',this.props.viewer_id);new (c('AsyncRequest'))(q.getURI()).setMethod('POST').setHandler(function(r){var s=r.getPayload();c('DOM').setContent(this.actionsWrapper,s.actions);var t=false;if(s.cr_actions){c('DOM').setContent(this.crActionsWrapper,s.cr_actions);t=true;}this.setState({actionsLoaded:true,showCrActions:t});}.bind(this)).send();};o.prototype.getLoggingData=function(){if(this.loggingData!=null)return this.loggingData;var p=c('SearchEntityModuleServerConstants').TYPE_TO_DISPLAY_STYLE[this.props.result.type],q=c('SearchEntityModuleServerConstants').TYPE_TO_BROWSE_TYPE[this.props.result.type],r=c('SearchEntityModuleServerConstants').WWW_GRAPH_SEARCH_RESULTS_TRACKABLE_CODE,s=r+JSON.stringify({display_style:p,id:this.props.result.tuid,item_type:'result',module_result_type:q,module_type:this.props.module_role,position_in_module:this.props.position_in_module,query:this.props.browse_query,raw_id:parseInt(this.props.result.tuid,10),session_id:this.props.browse_session_id,vertical:'content',is_bootstrap:this.props.result.is_bootstrap,unit_id:this.props.result.logging_unit_id,unit_id_click_type:c('SearchEntityModuleServerConstants').BEM_UNIT_ID_CLICK_TYPE,unit_id_result_id:this.props.result.tuid});this.loggingData={'data-xt':s,'data-gt':JSON.stringify({type:'xtracking',xt:s}),'data-bt':JSON.stringify({id:parseInt(this.props.result.tuid,10)}),'data-xt-vimp':JSON.stringify(this.props.client_view_config),'data-vistracking':'1','data-insertion-position':this.props.position_in_module};return this.loggingData;};o.prototype.logImpression=function(){var p=this.getLoggingData();c('BrowseClientEventLogger').logImpression({xt:p['data-xt']});};o.prototype.logUnitData=function(){var p=this.props.result,q=c('XSearchBootstrapEntityModuleLoggingController').getURIBuilder().setString('logging_unit_id',p.logging_unit_id).setString('session_id',this.props.browse_session_id).setString('query',this.props.plain_text_query).setString('query_function',this.props.browse_query).setString('tapped_results_entity_id',p.tuid).setString('results_module_role',p.module_role).setBool('log_module_impression',false);new (c('AsyncRequest'))(q.getURI()).send();};f.exports=o;}),null);
__d('SearchEntityModule.react',['cx','fbt','AsyncRequest','Link.react','React','SearchEntityModuleResult.react','SearchEntityModuleServerConstants','XSearchBootstrapEntityModuleLoggingController','XUICard.react','XUICardHeader.react','XUICardHeaderTitle.react','XUICardSection.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;j=babelHelpers.inherits(l,c('React').Component);k=j&&j.prototype;function l(m){k.constructor.call(this,m);this.onSeeMoreLinkClick=function(event){event.preventDefault();this.setState({isExpanded:true});}.bind(this);this.state={isExpanded:this.props.num_results_to_show==null};this.seeMoreLoggingData={};}l.prototype.componentDidMount=function(){if(this.props.logging_unit_id!=null&&this.props.is_bootstrap_entity_module)this.logUnitData();};l.prototype.render=function(){var m=this.props.num_results_to_show,n=!this.state.isExpanded&&m!=null?this.props.results.slice(0,m):this.props.results;if(n.count()===0)return c('React').createElement('div',null);n=n.map(function(s,t){return c('React').createElement(c('SearchEntityModuleResult.react'),{key:s.tuid,result:s,position_in_module:t,browse_query:this.props.browse_query,client_view_config:this.props.client_view_config,browse_session_id:this.props.browse_session_id,typeahead_session_id:this.props.typeahead_session_id,module_style:this.props.module_style,module_role:this.props.module_role,results:this.props.results,plain_text_query:this.props.plain_text_query,logging_unit_id:this.props.logging_unit_id,callsite:this.props.callsite,has_module_guidelines:this.props.has_module_guidelines,viewer_id:this.props.viewer_id});}.bind(this));var o=c('React').createElement(c('Link.react'),babelHelpers['extends']({},this.getSeeMoreLoggingData('footer'),{href:'',onClick:this.onSeeMoreLinkClick,className:"_5w9f"+(this.state.isExpanded||m==null||this.props.results.size<=m?' '+"hidden_elem":'')}),i._("See All")),p=void 0,q=void 0;if(this.props.see_more_uri!=null){p=c('React').createElement(c('Link.react'),babelHelpers['extends']({},this.getSeeMoreLoggingData('header'),{href:this.props.see_more_uri}),i._("See All"));q=c('React').createElement(c('Link.react'),babelHelpers['extends']({},this.getSeeMoreLoggingData('footer'),{href:this.props.see_more_uri,className:"_5w9f"+(!this.state.isExpanded&&m!=null&&this.props.results.size>m?' '+"hidden_elem":'')}),i._("See All"));}var r=this.props.title instanceof Object&&this.props.title.__html!=null?c('React').createElement('span',{dangerouslySetInnerHTML:this.props.title}):this.props.title;return c('React').createElement('div',{className:"_5w7z"+(this.props.result_type==='user'&&this.props.module_role==='SHORTCUT_PEOPLE'?' '+"_d7o":'')+(this.props.result_type==='user'?' '+"_5w81":'')+(this.props.result_type==='page'?' '+"_5w82":'')+(this.props.result_type==='group'?' '+"_5w84":'')+(this.props.result_type==='application'?' '+"_3h4u":'')+(this.props.result_type==='place'?' '+"_5w9b":'')+(this.props.result_type==='event'?' '+"_5w9c":'')},c('React').createElement(c('XUICard.react'),{className:"_5w9d"},c('React').createElement(c('XUICardHeader.react'),{link:p,type:'primary'},c('React').createElement(c('XUICardHeaderTitle.react'),null,c('React').createElement('div',{className:"_5w9e"}),r)),c('React').createElement(c('XUICardSection.react'),null,n,o,q)));};l.prototype.getSeeMoreLoggingData=function(m){if(this.seeMoreLoggingData[m]!=null)return this.seeMoreLoggingData[m];var n=c('SearchEntityModuleServerConstants').WWW_GRAPH_SEARCH_RESULTS_TRACKABLE_CODE,o=c('SearchEntityModuleServerConstants').SEE_MORE_LOGGING.MODULE_HEADER_ITEM_TYPE,p=c('SearchEntityModuleServerConstants').SEE_MORE_LOGGING.MODULE_FOOTER_ITEM_TYPE,q=n+JSON.stringify({item_type:m==='header'?o:p,module_type:this.props.module_role,query:this.props.browse_query,session_id:this.props.browse_session_id,source_module_role:this.props.module_role,vertical:'content'});this.seeMoreLoggingData[m]={'data-xt':q,'data-gt':JSON.stringify({type:'xtracking',xt:q}),'data-xt-vimp':JSON.stringify(this.props.client_view_config),'data-vistracking':'1','data-bt':JSON.stringify({ct:'see_more',source_module_role:this.props.module_role})};return this.seeMoreLoggingData[m];};l.prototype.logUnitData=function(){var m=c('XSearchBootstrapEntityModuleLoggingController').getURIBuilder().setString('logging_unit_id',this.props.logging_unit_id).setString('session_id',this.props.browse_session_id).setString('query',this.props.plain_text_query).setString('query_function',this.props.browse_query).setString('results_module_role',this.props.module_role).setBool('log_module_impression',true);new (c('AsyncRequest'))(m.getURI()).send();};f.exports=l;}),null);
__d('SearchEntityModuleContainer.react',['FluxContainer','immutable','React','SearchEntityModule.react','SearchEntityModuleActions','SearchEntityModuleContainerStore','SearchEntityModuleDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.getStores=function(){return [c('SearchEntityModuleContainerStore')];};j.calculateState=function(k,l){return {modules:c('SearchEntityModuleContainerStore').getModules(l.browse_session_id)};};j.prototype.componentWillMount=function(){c('SearchEntityModuleDispatcher').explicitlyRegisterStores([c('SearchEntityModuleContainerStore')]);};j.prototype.componentWillUnmount=function(){c('SearchEntityModuleActions').clearAllResultsAndModules(this.props.browse_session_id);};j.prototype.render=function(){var k=this.state.modules,l=k.find(function(n){return n.role===this.props.module_role&&n.is_bootstrap_entity_module===this.props.is_bootstrap_entity_module;}.bind(this));if(l!=null&&l.component==null){l.component=this;c('SearchEntityModuleActions').addResultsToModule(this.props.browse_session_id,{role:this.props.module_role,is_bootstrap_entity_module:this.props.is_bootstrap_entity_module},c('immutable').List(this.props.results));this.forceUpdate();return c('React').createElement('div',null);}if(l!=null&&l.component===this){var m=c('SearchEntityModuleContainerStore').getResults(this.props.browse_session_id,{role:this.props.module_role,is_bootstrap_entity_module:this.props.is_bootstrap_entity_module});return c('React').createElement(c('SearchEntityModule.react'),{plain_text_query:this.props.plain_text_query,browse_query:this.props.browse_query,module_role:this.props.module_role,result_type:this.props.result_type,results:m,num_results_to_show:this.props.num_results_to_show,client_view_config:this.props.client_view_config,typeahead_session_id:this.props.typeahead_session_id,browse_session_id:this.props.browse_session_id,module_style:this.props.module_style,title:this.props.title,see_more_uri:this.props.see_more_uri,logging_unit_id:this.props.logging_unit_id,is_bootstrap_entity_module:this.props.is_bootstrap_entity_module,callsite:this.props.callsite,has_module_guidelines:this.props.has_module_guidelines,viewer_id:this.props.viewer_id});}return c('React').createElement('div',null);};function j(){h.apply(this,arguments);}f.exports=c('FluxContainer').create(j,{withProps:true});}),null);
__d('SearchBootstrapEntityModule',['cx','fbt','Arbiter','BanzaiODS','DOM','FacebarJSConstants','immutable','JSLogger','React','ReactRenderer','SearchEntityModuleContainer.react','SearchEntityModuleContainerStore','SearchEntityModuleDispatcher','SearchEntityModuleServerConstants','SearchEntityModuleUtils','URI','XUINotice.react','$','md5','randomInt','tidyEvent'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=false,k='pagelet_loader_browse:independent:modules:pagelet',l='pagelet_loader_initial_browse_result',m='www_bem_res',n=c('immutable').Map(),o={backend_faster_no_matches:'BEM not shown because backend returned faster but had no matches anyway',backend_faster_with_matches:'BEM had matches but backend was faster',no_matches:'BEM not shown as no matches were found',no_entity_type:'BEM not shown as no user/page/place/group/event found',no_title_found:'BEM not shown as no title for module found',shown:'BEM shown'},p=void 0,q=[];function r(u){return u+':'+c('md5')(String(c('randomInt')(0,Number.MAX_SAFE_INTEGER)));}function s(u,v){var w=n.get(u);if(w==null){w=c('immutable').Map();n.set(u,w);}var x=w.get(v.tuid);if(x==null){x=r(m);w.set(v.tuid,x);}return x;}var t={init:function u(v){c('tidyEvent')(c('Arbiter').subscribe('pagelet_event',function(event,x){if(event==='display'&&(x.id===k||x.id===l))j=true;}),c('Arbiter').subscribe(c('JSLogger').DUMP_EVENT,function(event,x){x.searchBootstrapEntityModule={notice:o[p],matches:JSON.stringify(q)};}));var w=v.squashed_ent_ids?v.squashed_ent_ids:[];c('Arbiter').inform('FacebarDataSource.getBootstrapMatches',{query:v.plain_text_query,callback:function x(y){t.onBootstrapResponse(v,y);},whitelistedEntIds:w},c('Arbiter').BEHAVIOR_PERSISTENT);},onBootstrapResponse:function u(v,w){if(j||w.length===0){if(j){t.printDebugNotice(v,w.length===0?'backend_faster_no_matches':'backend_faster_with_matches',w);}else t.printDebugNotice(v,'no_matches');return;}w=w.sort(function(ca,da){return ca.bootstrapCost-da.bootstrapCost;});var x=void 0;w=w.reduce(function(ca,da){da=babelHelpers['extends']({},da);if(da.type==='app')da.type='application';if(da.render_type==='place')da.type='place';if(x==null&&da.type!==c('FacebarJSConstants').keywordType)x=da.type;if(da.type===x&&ca.length<v.num_bootstrap_entity_results_to_show){if(da.subtext!=null){da.snippets=da.subtext.split(/\s*\u00B7s*/g).map(function(fa){return c('DOM').create('span',{},fa);});var ea=da.snippets.pop();da.snippets=da.snippets.slice(0,v.num_snippets-1);if(ea!=null)da.snippets.push(ea);}else da.snippets=[];da.is_bootstrap=true;if(x!=null)da.module_role=c('SearchEntityModuleServerConstants').RESULT_TYPE_TO_MODULE_ROLE[x];da.logging_unit_id=s(v.browse_session_id,da);da.uri=new (c('URI'))(da.path).addQueryData('ref',c('SearchEntityModuleServerConstants').BROWSE_RESULTS_PAGE_REF);ca.push(da);}return ca;},[]);if(x==null){t.printDebugNotice(v,'no_entity_type',w);return;}var y=null;switch(x){case 'user':y=i._("People");break;case 'page':y=i._("Pages");break;case 'group':y=i._("Groups");break;case 'application':y=i._("Apps");break;case 'place':y=i._("Places");break;case 'event':y=i._("Events");break;}if(y==null){t.printDebugNotice(v,'no_title_found',w);return;}var z=new (c('URI'))(c('SearchEntityModuleServerConstants').TYPE_TO_SERP_PATH[x]).setQueryData({q:v.plain_text_query,ref:v.see_more_ref});c('SearchEntityModuleDispatcher').explicitlyRegisterStores([c('SearchEntityModuleContainerStore')]);var aa=c('SearchEntityModuleContainerStore').getModules(v.browse_session_id);if(aa.size>0){t.printDebugNotice(v,'backend_faster_with_matches',w);return;}var ba=c('SearchEntityModuleServerConstants').RESULT_TYPE_TO_MODULE_ROLE[x];c('SearchEntityModuleUtils').addModules([{role:ba,is_bootstrap_entity_module:true}],v.browse_session_id);t.printDebugNotice(v,'shown',w);c('ReactRenderer').constructAndRenderComponent(c('SearchEntityModuleContainer.react'),{plain_text_query:v.plain_text_query,browse_query:v.browse_query,results:w,result_type:x,module_role:ba,is_bootstrap_entity_module:true,num_results_to_show:v.num_results_to_show,client_view_config:v.client_view_config,browse_session_id:v.browse_session_id,typeahead_session_id:v.typeahead_session_id,module_style:v.module_style,title:y,see_more_uri:z,logging_unit_id:v.logging_unit_id,callsite:v.callsite,has_module_guidelines:v.has_module_guidelines,viewer_id:v.viewer_id,squashed_ent_ids:v.squashed_ent_ids},v.root);},printDebugNotice:function u(v,w,x){p=w;q=x;c('BanzaiODS').bumpEntityKey('search.www.bem',w);if(!v.debug)return;var y=c('DOM').create('div');c('ReactRenderer').renderComponent(c('React').createElement(c('XUINotice.react'),{className:"_3-96"},'FB Only: ',o[w],'.'),y);c('DOM').prependContent(c('$')('browse_result_area'),y);}};f.exports=t;}),null);